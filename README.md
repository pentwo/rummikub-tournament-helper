# Rummikub Tournament Helper - Web App é–‹ç™¼è¨ˆç•«

## å°ˆæ¡ˆæ¦‚è¿°

å»ºç«‹ä¸€å€‹ Rummikub éŒ¦æ¨™è³½ç®¡ç† Web Appï¼Œæ”¯æ´å¤šæ¡ŒåŒæ™‚é€²è¡Œï¼Œæ¯æ¡Œç©å®¶è‡ªè¡Œæ“ä½œè¨ˆæ™‚/è¨ˆåˆ†ï¼Œé›»è¦–å¤§è¢å¹•å³æ™‚é¡¯ç¤ºæˆ°æ³æ’è¡Œæ¦œã€‚

## æŠ€è¡“æ¶æ§‹

### æŠ€è¡“é¸æ“‡
- **Framework**: Next.js 15 (App Router)
- **UI**: Tailwind CSSï¼ˆç°¡æ½”å¿«é€Ÿï¼‰
- **ç‹€æ…‹åŒæ­¥**: Next.js API Routes + Polling
- **è³‡æ–™å„²å­˜**: Vercel KV (Redis)
- **éƒ¨ç½²**: Vercel

### å³æ™‚åŒæ­¥æ–¹æ¡ˆï¼ˆå·²é¸å®šï¼‰

**Next.js API Routes + Vercel KV**
- ä½¿ç”¨ Next.js API Routes ä½œç‚ºå¾Œç«¯
- Vercel KV (Redis) å„²å­˜è³‡æ–™ï¼Œå…è²»é¡åº¦å……è¶³
- é›»è¦–é é¢ä½¿ç”¨ Pollingï¼ˆæ¯ 2 ç§’ï¼‰å–å¾—æœ€æ–°ç‹€æ…‹
- éƒ¨ç½²åˆ° Vercelï¼Œæ‰‹æ©Ÿæƒ QR code å³å¯é€£ç·š

## é é¢çµæ§‹

### 1. é›»è¦– Dashboard (`/tv`)
å¤§è¢å¹•é¡¯ç¤ºï¼Œè‡ªå‹•æ›´æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ† Rummikub Tournament                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   æ¡Œ 1      â”‚  â”‚   æ¡Œ 2      â”‚  â”‚   æ¡Œ 3      â”‚     â”‚
â”‚  â”‚  ç¬¬ 3 ç›¤    â”‚  â”‚  ç¬¬ 2 ç›¤    â”‚  â”‚  ç¬¬ 1 ç›¤    â”‚     â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚     â”‚
â”‚  â”‚ ğŸŸ¢ å°æ˜     â”‚  â”‚    å°è¯     â”‚  â”‚    å°å¼·     â”‚     â”‚
â”‚  â”‚    å°ç¾     â”‚  â”‚ ğŸŸ¢ å°æ     â”‚  â”‚ ğŸŸ¢ å°ç‹     â”‚     â”‚
â”‚  â”‚    å°ç‹     â”‚  â”‚    å°å¼µ     â”‚  â”‚    å°é™³     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                    ğŸ† æ’è¡Œæ¦œ                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  1. å°æ˜ (+125)  2. å°è¯ (+80)  3. å°ç¾ (+45)  ...     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ç®¡ç†é é¢ (`/`)
ä¸»è¾¦æ–¹æ§åˆ¶å°

- æ–°å¢æ¡Œå­ï¼ˆè¼¸å…¥ 2-4 ä½ç©å®¶åç¨±ï¼‰
- æŸ¥çœ‹æ‰€æœ‰æ¡Œå­ç‹€æ…‹
- ç¸½æ’è¡Œæ¦œ
- ç•¶å¤©æ­·å²ç´€éŒ„

### 3. æ¡Œå­é é¢ (`/table/[id]`)
æ¯æ¡Œç©å®¶ä½¿ç”¨æ‰‹æ©Ÿæ“ä½œ

```
éŠæˆ²ä¸­ç‹€æ…‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      â±ï¸ 0:45            â”‚  <- å€’æ•¸è¨ˆæ™‚ï¼ˆèƒŒæ™¯é¡è‰²è®ŠåŒ–æç¤ºï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚         SM              â”‚  <- ç©å®¶ Initial é ­åƒ
â”‚        å°æ˜             â”‚
â”‚       ç›®å‰è¼ªåˆ°          â”‚
â”‚                         â”‚
â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”    â”‚
â”‚   â”‚+25â”‚-10â”‚+5 â”‚-20â”‚    â”‚  <- å„ç©å®¶æœ¬ç›¤åˆ†æ•¸
â”‚   â”‚å°æ˜â”‚å°ç¾â”‚å°ç‹â”‚å°æ â”‚
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜    â”‚
â”‚                         â”‚
â”‚  [ é»æ“Šä»»æ„è™•åˆ‡æ›ç©å®¶ ]  â”‚
â”‚                         â”‚
â”‚     [çµæŸæœ¬ç›¤]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

çµç®—ç‹€æ…‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æœ¬ç›¤çµç®—            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èª°è´äº†ï¼Ÿ               â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”         â”‚
â”‚  â”‚å°æ˜â”‚ â”‚å°ç¾â”‚  ...     â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¼¸å®¶è¼¸å…¥å‰©é¤˜ç‰Œåˆ†æ•¸ï¼š   â”‚
â”‚  å°ç¾: [  15  ]         â”‚
â”‚  å°ç‹: [  20  ]         â”‚
â”‚  å°æ: [  10  ]         â”‚
â”‚                         â”‚
â”‚  å°æ˜ ç²å¾—: +45         â”‚
â”‚                         â”‚
â”‚     [ç¢ºèªçµç®—]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨ˆæ™‚å™¨ UI é¡è‰²è®ŠåŒ–

| å‰©é¤˜æ™‚é–“ | èƒŒæ™¯é¡è‰² |
|----------|----------|
| > 30 ç§’  | ç¶ è‰² |
| 15-30 ç§’ | é»ƒè‰² |
| < 15 ç§’  | ç´…è‰² |
| 0 ç§’     | æ·±ç´…é–ƒçˆ |

## è³‡æ–™æ¨¡å‹

```typescript
// ç©å®¶
interface Player {
  id: string;
  name: string;
  initial: string;  // åå­—é¦–å­—æ¯ï¼Œå¦‚ "å°æ˜" -> "æ˜" æˆ– "SM"
  totalScore: number;  // ç´¯ç©ç¸½åˆ†
}

// æ¡Œå­
interface Table {
  id: string;
  players: string[];  // player IDs
  currentPlayerIndex: number;
  currentRound: number;
  status: 'playing' | 'scoring' | 'finished';
  timerStartedAt: number | null;
}

// å–®ç›¤è¨˜éŒ„
interface Round {
  id: string;
  tableId: string;
  roundNumber: number;
  winnerId: string;
  scores: Record<string, number>;  // playerId -> score
  timestamp: number;
}

// ç•¶å¤©è¨˜éŒ„
interface TournamentData {
  date: string;  // YYYY-MM-DD
  players: Player[];
  tables: Table[];
  rounds: Round[];
}
```

## å¯¦ä½œæ­¥é©Ÿ

### Phase 1: å°ˆæ¡ˆåˆå§‹åŒ–
1. åˆå§‹åŒ– Next.js 15 å°ˆæ¡ˆ + Tailwind CSS
2. å®‰è£ @vercel/kv å¥—ä»¶
3. å»ºç«‹ TypeScript é¡å‹å®šç¾© (`src/types/index.ts`)
4. å»ºç«‹ Vercel KV æ“ä½œå‡½æ•¸ (`src/lib/kv.ts`)

### Phase 2: API Routes
5. `GET/POST /api/tournament` - éŒ¦æ¨™è³½è³‡æ–™
6. `GET/POST /api/tables` - æ¡Œå­ CRUD
7. `GET/PUT /api/tables/[id]` - å–®ä¸€æ¡Œå­æ“ä½œ
8. `POST /api/rounds` - è¨˜éŒ„å›åˆçµæœ

### Phase 3: å…±ç”¨å…ƒä»¶
9. `PlayerAvatar` - ç©å®¶é ­åƒï¼ˆInitialï¼‰
10. `Timer` - 60 ç§’å€’æ•¸è¨ˆæ™‚å™¨ï¼ˆé¡è‰²è®ŠåŒ–ï¼‰
11. `Leaderboard` - æ’è¡Œæ¦œ
12. `TableCard` - æ¡Œå­ç‹€æ…‹å¡ç‰‡
13. `ScoreInput` - åˆ†æ•¸è¼¸å…¥å…ƒä»¶

### Phase 4: é é¢å¯¦ä½œ
14. ç®¡ç†é é¢ (`/`) - æ–°å¢æ¡Œå­ã€æŸ¥çœ‹ç‹€æ…‹ã€æ’è¡Œæ¦œ
15. æ¡Œå­é é¢ (`/table/[id]`) - è¨ˆæ™‚ã€åˆ‡æ›ç©å®¶ã€çµç®—
16. é›»è¦– Dashboard (`/tv`) - å¤§è¢å¹•é¡¯ç¤ºã€è‡ªå‹•è¼ªè©¢

### Phase 5: éƒ¨ç½²
17. è¨­å®š Vercel KV ç’°å¢ƒè®Šæ•¸
18. éƒ¨ç½²åˆ° Vercel

## æª”æ¡ˆçµæ§‹

```
rummikub-tourment-helper/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.tsx              # ç®¡ç†é é¢
â”‚   â”‚   â”œâ”€â”€ tv/page.tsx           # é›»è¦– Dashboard
â”‚   â”‚   â”œâ”€â”€ table/[id]/page.tsx   # æ¡Œå­é é¢
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ tournament/route.ts    # GET/POST éŒ¦æ¨™è³½è³‡æ–™
â”‚   â”‚   â”‚   â”œâ”€â”€ tables/route.ts        # GET/POST æ¡Œå­
â”‚   â”‚   â”‚   â”œâ”€â”€ tables/[id]/route.ts   # GET/PUT å–®ä¸€æ¡Œå­
â”‚   â”‚   â”‚   â””â”€â”€ rounds/route.ts        # POST æ–°å¢å›åˆè¨˜éŒ„
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ TableCard.tsx         # æ¡Œå­å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ PlayerAvatar.tsx      # ç©å®¶é ­åƒ (Initial)
â”‚   â”‚   â”œâ”€â”€ Timer.tsx             # å€’æ•¸è¨ˆæ™‚å™¨
â”‚   â”‚   â”œâ”€â”€ Leaderboard.tsx       # æ’è¡Œæ¦œ
â”‚   â”‚   â”œâ”€â”€ ScoreInput.tsx        # åˆ†æ•¸è¼¸å…¥
â”‚   â”‚   â””â”€â”€ CreateTableModal.tsx  # æ–°å¢æ¡Œå­å½ˆçª—
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useTimer.ts           # è¨ˆæ™‚å™¨ hook
â”‚   â”‚   â”œâ”€â”€ useTournament.ts      # è³‡æ–™ fetch hook
â”‚   â”‚   â””â”€â”€ usePolling.ts         # è¼ªè©¢ hook
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ kv.ts                 # Vercel KV æ“ä½œ
â”‚   â”‚   â””â”€â”€ utils.ts              # å·¥å…·å‡½æ•¸
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts              # TypeScript é¡å‹
â”œâ”€â”€ package.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ tsconfig.json
```

## API è¨­è¨ˆ

### `GET /api/tournament`
å–å¾—ç•¶å¤©æ‰€æœ‰è³‡æ–™ï¼ˆç©å®¶ã€æ¡Œå­ã€å›åˆè¨˜éŒ„ï¼‰

### `POST /api/tables`
æ–°å¢æ¡Œå­
```json
{ "playerNames": ["å°æ˜", "å°ç¾", "å°ç‹", "å°æ"] }
```

### `PUT /api/tables/[id]`
æ›´æ–°æ¡Œå­ç‹€æ…‹ï¼ˆåˆ‡æ›ç©å®¶ã€é–‹å§‹çµç®—ç­‰ï¼‰
```json
{ "currentPlayerIndex": 1, "status": "playing" }
```

### `POST /api/rounds`
è¨˜éŒ„ä¸€ç›¤çµæœ
```json
{
  "tableId": "xxx",
  "winnerId": "player-1",
  "scores": { "player-1": 45, "player-2": -15, "player-3": -20, "player-4": -10 }
}
```
